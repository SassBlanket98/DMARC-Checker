<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Enhanced DMARC Checker</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/error_handling.css') }}"
    />
  </head>
  <body>
    <header>
      <div class="header-container">
        <div class="app-title">
          <i class="fas fa-shield-alt"></i>
          <span>Enhanced DMARC Checker</span>
        </div>
        <nav>
          <ul>
            <li>
              <a href="#" class="active"><i class="fas fa-home"></i> Home</a>
            </li>
            <li>
              <a href="#" id="help-link"
                ><i class="fas fa-question-circle"></i> Help</a
              >
            </li>
            <li>
              <a href="#" id="history-link"
                ><i class="fas fa-history"></i> History</a
              >
            </li>
          </ul>
        </nav>
      </div>
    </header>

    <main>
      <div class="controls">
        <button class="theme-toggle" aria-label="Toggle dark mode">
          <i class="fas fa-moon"></i>
        </button>
      </div>

      <div class="container">
        <h2>Email Authentication Record Checker</h2>
        <div class="input-group">
          <div class="input-wrapper">
            <input
              type="text"
              id="domain"
              placeholder="Enter a domain (e.g., example.com)"
              autocomplete="off"
            />
            <div class="domain-autocomplete" id="domain-suggestions"></div>
          </div>
          <div class="input-wrapper">
            <select id="recordType">
              <option value="overview">Overview (All Records)</option>
              <option value="dmarc">DMARC</option>
              <option value="spf">SPF</option>
              <option value="dkim">DKIM</option>
              <option value="dns">DNS</option>
            </select>
          </div>
        </div>

        <div id="selectors-container" class="selectors-container">
          <h3>
            DKIM Selectors
            <span class="tooltip"
              ><i class="fas fa-info-circle"></i>
              <span class="tooltip-text"
                >Specify DKIM selectors to check. Common selectors include:
                default, google, selector1, selector2, email, dkim1</span
              >
            </span>
          </h3>
          <div class="selectors-list" id="selectors-list">
            <!-- Selector tags will be added here -->
          </div>
          <div class="add-selector">
            <input
              type="text"
              id="new-selector"
              placeholder="Enter a selector"
            />
            <button id="add-selector-btn" class="secondary">Add</button>
          </div>
        </div>

        <div class="button-group">
          <button id="check-btn">
            <i class="fas fa-search"></i> Check Records
          </button>
          <button id="batch-check-btn" class="secondary">
            <i class="fas fa-layer-group"></i> Batch Check
          </button>
          <button id="export-btn" class="secondary">
            <i class="fas fa-file-export"></i> Export Results
          </button>
        </div>
      </div>

      <div id="overview-container" class="container" style="display: none">
        <h2>Authentication Score</h2>
        <div class="score-container">
          <div class="score-circle" style="--score-percent: 75%">
            <div class="score-value">75%</div>
          </div>
          <div class="score-label">Email Authentication Score</div>

          <div class="score-details">
            <div class="score-item">
              <div class="score-item-label">DMARC</div>
              <div class="score-item-value" style="color: var(--success-color)">
                <i class="fas fa-check-circle"></i>
              </div>
            </div>
            <div class="score-item">
              <div class="score-item-label">SPF</div>
              <div class="score-item-value" style="color: var(--success-color)">
                <i class="fas fa-check-circle"></i>
              </div>
            </div>
            <div class="score-item">
              <div class="score-item-label">DKIM</div>
              <div class="score-item-value" style="color: var(--warning-color)">
                <i class="fas fa-exclamation-triangle"></i>
              </div>
            </div>
            <div class="score-item">
              <div class="score-item-label">MX</div>
              <div class="score-item-value" style="color: var(--success-color)">
                <i class="fas fa-check-circle"></i>
              </div>
            </div>
          </div>
        </div>

        <div class="issues-container">
          <h3>Issues & Recommendations</h3>

          <div class="issue-item issue-warning">
            <div class="issue-icon">
              <i class="fas fa-exclamation-triangle"></i>
            </div>
            <div class="issue-content">
              <div class="issue-title">DMARC Policy set to 'none'</div>
              <div class="issue-description">
                Your DMARC policy is currently set to 'none', which only
                monitors emails without taking action on failures. For better
                protection, consider upgrading to 'quarantine' or 'reject'.
              </div>
            </div>
          </div>

          <div class="issue-item issue-info">
            <div class="issue-icon">
              <i class="fas fa-info-circle"></i>
            </div>
            <div class="issue-content">
              <div class="issue-title">
                Missing DKIM Records for Common Selectors
              </div>
              <div class="issue-description">
                We couldn't find DKIM records for some common selectors. Try
                adding selectors specifically used by your email service
                provider.
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="container">
        <h2>Record Details</h2>
        <div class="results">
          <div id="result">
            Enter a domain and check records to see results here.
          </div>
        </div>
      </div>
    </main>

    <!-- History Drawer -->
    <div id="history-drawer" class="history-drawer">
      <div class="drawer-header">
        <h2>Recent Lookups</h2>
        <button class="drawer-close" id="history-close">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="history-list">
        <!-- Sample history items -->
        <div class="history-item">
          <div class="history-domain">example.com</div>
          <div class="history-date">
            February 27, 2025 - 10:23 AM
            <span class="history-record-type">Overview</span>
          </div>
        </div>
        <div class="history-item">
          <div class="history-domain">example.org</div>
          <div class="history-date">
            February 27, 2025 - 10:20 AM
            <span class="history-record-type">DMARC</span>
          </div>
        </div>
        <div class="history-item">
          <div class="history-domain">google.com</div>
          <div class="history-date">
            February 27, 2025 - 10:15 AM
            <span class="history-record-type">SPF</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="modal-backdrop">
      <div class="modal">
        <div class="modal-header">
          <div class="modal-title">DMARC Checker Help & Information</div>
          <button class="modal-close" id="help-close">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="modal-section">
            <h3>What is Email Authentication?</h3>
            <p>
              Email authentication is a set of techniques to verify the identity
              of email senders, prevent email spoofing, and reduce spam and
              phishing attacks. The primary authentication methods are:
            </p>
            <ul>
              <li>
                <strong
                  >DMARC (Domain-based Message Authentication, Reporting &
                  Conformance)</strong
                >
                - A policy framework that builds on SPF and DKIM to improve
                protection against spoofing and phishing.
              </li>
              <li>
                <strong>SPF (Sender Policy Framework)</strong> - Verifies that
                email messages are sent from authorized mail servers.
              </li>
              <li>
                <strong>DKIM (DomainKeys Identified Mail)</strong> - Adds a
                digital signature to emails that can be validated by receiving
                mail servers.
              </li>
            </ul>
          </div>

          <div class="modal-section">
            <h3>How to Use This Tool</h3>
            <ol>
              <li>
                Enter a domain name (e.g., example.com) in the domain field.
              </li>
              <li>
                Select the record type you want to check (or use "Overview" to
                check all records).
              </li>
              <li>
                If checking DKIM records, you can specify selectors to check.
              </li>
              <li>
                Click "Check Records" to retrieve and analyze the domain's
                records.
              </li>
              <li>
                View the results, recommendations, and email authentication
                score.
              </li>
            </ol>
          </div>

          <div class="modal-section">
            <h3>Understanding Results</h3>
            <p>The tool provides the following information:</p>
            <ul>
              <li>
                <strong>Authentication Score</strong> - An overall score based
                on the implementation of email authentication methods.
              </li>
              <li>
                <strong>Record Details</strong> - Both raw and parsed data for
                each record type.
              </li>
              <li>
                <strong>Issues & Recommendations</strong> - Identified issues
                and suggestions to improve email authentication.
              </li>
            </ul>
          </div>

          <div class="modal-section">
            <h3>Common DKIM Selectors</h3>
            <p>
              DKIM selectors are used to retrieve the public key for validating
              email signatures. Common selectors by service:
            </p>
            <ul>
              <li>
                <strong>Google Workspace / Gmail</strong>: google, 20161025,
                20150623
              </li>
              <li><strong>Microsoft 365</strong>: selector1, selector2</li>
              <li><strong>Amazon SES</strong>: amazonses</li>
              <li><strong>Mailchimp</strong>: k1, k2, k3</li>
              <li><strong>SendGrid</strong>: s1, s2</li>
              <li><strong>Zoho</strong>: zoho</li>
              <li>
                <strong>Others</strong>: default, dkim, mail, email, dkim1
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <p>&copy; 2025 Enhanced DMARC Checker | All Rights Reserved</p>
    </footer>

    <!-- JavaScript -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
  </body>
</html>
